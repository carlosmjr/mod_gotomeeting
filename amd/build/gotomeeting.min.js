define(["jquery","core/ajax","mod_gotomeeting/jquery.dataTables","core/notification"],function(a,b,c,d){return{init:function(){},add_datatables_upusers:function(c){courseid=c.course,M.util.js_pending("mod_gotomeeting_loading_users_updateables"+courseid),a.when(b.call([{methodname:"mod_gotomeeting_load_users_updateables",args:{courseid:c.course}}])[0]).then(function(e){var f=(e.map(function(a){return a.hasOwnProperty("id")&&(a.DT_RowId=a.id,delete a.id),a}),a(c.selector));f.dataTable({lengthMenu:[[c.length,2*c.length,4*c.length,-1],[c.length,2*c.length,4*c.length,M.str.mod_gotomeeting.datatables_all]],bAutoWidth:!1,sPaginationType:"full_numbers",data:e,fixedHeader:!0,columns:[{data:"class"},{data:"name"},{data:"email"},{data:"entry"},{data:"end"},{data:"duration"},{data:"student",className:"goto_student"}],oLanguage:{oAria:{sSortAscending:M.str.mod_gotomeeting.datatables_sortascending,sSortDescending:M.str.mod_gotomeeting.datatables_sortdescending},oPaginate:{sFirst:M.str.mod_gotomeeting.datatables_first,sLast:M.str.mod_gotomeeting.datatables_last,sNext:M.str.mod_gotomeeting.datatables_next,sPrevious:M.str.mod_gotomeeting.datatables_previous},sEmptyTable:M.str.mod_gotomeeting.datatables_emptytable,sInfo:M.str.mod_gotomeeting.datatables_info,sInfoEmpty:M.str.mod_gotomeeting.datatables_infoempty,sInfoFiltered:M.str.mod_gotomeeting.datatables_infofiltered,sInfoThousands:M.str.langconfig.thousandssep,sLengthMenu:M.str.mod_gotomeeting.datatables_lengthmenu,sLoadingRecords:M.str.mod_gotomeeting.datatables_loadingrecords,sProcessing:M.str.mod_gotomeeting.datatables_processing,sSearch:M.str.mod_gotomeeting.datatables_search,sZeroRecords:M.str.mod_gotomeeting.datatables_zerorecords},fnDrawCallback:function(e){var g=this.api(),h=g.rows().data().length,i=g.rows({page:"current"}).data().length,j="#"+a(this).attr("id")+"_wrapper";h>i?(a(j).find("div.dataTables_paginate")[0].style.display="block",a(j).find("div.dataTables_length")[0].style.display="block"):(a(j).find("div.dataTables_paginate")[0].style.display="none",a(j).find("div.dataTables_length")[0].style.display="none");var k='<select name="gotoselectuser"><option value="0"></option>';for(var l in c.optionsusers)k+='<option value="'+l+'">'+c.optionsusers[l]+"</option>";k+="</select>",f.find("td.goto_student").each(function(b){$userid=a(this).text(),a(this).html(k),$userid&&a(this).find('select option[value="'+$userid+'"]').attr("selected",!0)}),f.find("td.goto_student select").change(function(e){var f=a(this).val(),g=a(this).parents("tr:first").attr("id");M.util.js_pending("mod_gotomeeting_updating_user"+g),a.when(b.call([{methodname:"mod_gotomeeting_update_user",args:{attendaceid:g,userid:f}}])[0]).then(function(a){location.href=c.url}).always(function(){M.util.js_complete("update_user"+g)}).fail(d.exception)})}})}).always(function(){M.util.js_complete("mod_gotomeeting_loading_users_updateables"+courseid)}).fail(d.exception)}}});